\hypertarget{main3_8c}{\section{main3.\+c File Reference}
\label{main3_8c}\index{main3.\+c@{main3.\+c}}
}
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$assert.\+h$>$}\\*
{\ttfamily \#include \char`\"{}lwt.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}lwt\+\_\+chan.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}lwt\+\_\+cgrp.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{main3_8c_ac24e1ca366317fc627e4ba6ec3cbc67b}{rdtscll}(val)~\+\_\+\+\_\+asm\+\_\+\+\_\+ \+\_\+\+\_\+volatile\+\_\+\+\_\+(\char`\"{}rdtsc\char`\"{} \+: \char`\"{}=A\char`\"{} (val))
\item 
\#define \hyperlink{main3_8c_ab5b92945430bd0cb7a04673282cf70c3}{I\+T\+E\+R}~10000
\item 
\#define \hyperlink{main3_8c_a3db88558f13bd13a54a3de94274b332c}{I\+S\+\_\+\+R\+E\+S\+E\+T}()
\item 
\#define \hyperlink{main3_8c_a062da9b839764ca294c7858b4907f1cd}{G\+R\+P\+S\+Z}~3
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void $\ast$ \hyperlink{main3_8c_ae14ebcd5dbd5dc45bb763e27bfdab8be}{fn\+\_\+bounce} (void $\ast$d)
\item 
void $\ast$ \hyperlink{main3_8c_ae27eac94e8bd220bd0eb50f4d162a76c}{fn\+\_\+null} (void $\ast$d)
\item 
void \hyperlink{main3_8c_a3da997789e6bfbfb86c7c7a18b1e968b}{test\+\_\+perf} (void)
\item 
void $\ast$ \hyperlink{main3_8c_a30645ee9e662784cc10b862398ebcc1b}{fn\+\_\+identity} (void $\ast$d)
\item 
void $\ast$ \hyperlink{main3_8c_a2239ef46ee61712a03e136bdf12f48f8}{fn\+\_\+nested\+\_\+joins} (void $\ast$d)
\item 
void $\ast$ \hyperlink{main3_8c_a24b5f091923e0e385cdc00c7203743e8}{fn\+\_\+sequence} (void $\ast$d)
\item 
void $\ast$ \hyperlink{main3_8c_abb3978a7add7702306e8e04a08da168a}{fn\+\_\+join} (void $\ast$d)
\item 
void \hyperlink{main3_8c_a5e23c5a942628a1f2d682009e0366655}{test\+\_\+crt\+\_\+join\+\_\+sched} (void)
\item 
void $\ast$ \hyperlink{main3_8c_acb0898cb622df2c21d89396818622817}{fn\+\_\+chan} (lwt\+\_\+chan\+\_\+t to)
\item 
void \hyperlink{main3_8c_adbca2609b42b9d6b35a8077ac1e1f74d}{test\+\_\+perf\+\_\+channels} (int chsz)
\item 
void $\ast$ \hyperlink{main3_8c_a984f793205bf1b2e018162f3b3982117}{fn\+\_\+snder} (lwt\+\_\+chan\+\_\+t c, int v)
\item 
void $\ast$ \hyperlink{main3_8c_af57a14139aab6bc433c03c023339a2bb}{fn\+\_\+snder\+\_\+1} (lwt\+\_\+chan\+\_\+t c)
\item 
void $\ast$ \hyperlink{main3_8c_a5cd13e32f6cffd4ed63edb950213392f}{fn\+\_\+snder\+\_\+2} (lwt\+\_\+chan\+\_\+t c)
\item 
void \hyperlink{main3_8c_a4706597a095cdd68502e0a0a7bc10fc1}{test\+\_\+multisend} (int chsz)
\item 
void $\ast$ \hyperlink{main3_8c_a8b3ab68dc6ae48f6c2b2683734a55624}{fn\+\_\+async\+\_\+steam} (lwt\+\_\+chan\+\_\+t to)
\item 
void \hyperlink{main3_8c_a2f7cc657f5403703651e8a5cbecbc19a}{test\+\_\+perf\+\_\+async\+\_\+steam} (int chsz)
\item 
void $\ast$ \hyperlink{main3_8c_a86bf63b3460ce6076daf8fb200b3946d}{fn\+\_\+grpwait} (lwt\+\_\+chan\+\_\+t c)
\item 
void \hyperlink{main3_8c_a7c9d5eef978a751f1d94df73823a181a}{test\+\_\+grpwait} (int chsz, int grpsz)
\item 
int \hyperlink{main3_8c_a840291bc02cba5474a4cb46a9b9566fe}{main} (void)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile int \hyperlink{main3_8c_a545d0b226289b96d49f8744423287519}{sched} \mbox{[}2\mbox{]} = \{0, 0\}
\item 
volatile int \hyperlink{main3_8c_ad25cac179548d50aa5d5bf5739de6e22}{curr} = 0
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{main3_8c_a062da9b839764ca294c7858b4907f1cd}{\index{main3.\+c@{main3.\+c}!G\+R\+P\+S\+Z@{G\+R\+P\+S\+Z}}
\index{G\+R\+P\+S\+Z@{G\+R\+P\+S\+Z}!main3.\+c@{main3.\+c}}
\subsubsection[{G\+R\+P\+S\+Z}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+R\+P\+S\+Z~3}}\label{main3_8c_a062da9b839764ca294c7858b4907f1cd}
\hypertarget{main3_8c_a3db88558f13bd13a54a3de94274b332c}{\index{main3.\+c@{main3.\+c}!I\+S\+\_\+\+R\+E\+S\+E\+T@{I\+S\+\_\+\+R\+E\+S\+E\+T}}
\index{I\+S\+\_\+\+R\+E\+S\+E\+T@{I\+S\+\_\+\+R\+E\+S\+E\+T}!main3.\+c@{main3.\+c}}
\subsubsection[{I\+S\+\_\+\+R\+E\+S\+E\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+S\+\_\+\+R\+E\+S\+E\+T(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{main3_8c_a3db88558f13bd13a54a3de94274b332c}
{\bfseries Value\+:}
\begin{DoxyCode}
assert( \hyperlink{lwt_8c_a64fd4d406b656db93283cc4d1f7b7fc8}{lwt\_info}(\hyperlink{enums_8h_a1148b40d53237025b24f0b603b387e75ae4b17e581e13f286e6f10c22cf043c4f}{LWT\_INFO\_NTHD\_RUNNABLE}) == 1 &&  \(\backslash\)
        \hyperlink{lwt_8c_a64fd4d406b656db93283cc4d1f7b7fc8}{lwt\_info}(\hyperlink{enums_8h_a1148b40d53237025b24f0b603b387e75ac30e6a5e22c52f77696c3b28815fd6b9}{LWT\_INFO\_NTHD\_ZOMBIES}) == 0 &&        \(\backslash\)
        \hyperlink{lwt_8c_a64fd4d406b656db93283cc4d1f7b7fc8}{lwt\_info}(\hyperlink{enums_8h_a1148b40d53237025b24f0b603b387e75a2575a3edce296b761e59a983fc3536ec}{LWT\_INFO\_NTHD\_BLOCKED}) == 0)
\end{DoxyCode}
\hypertarget{main3_8c_ab5b92945430bd0cb7a04673282cf70c3}{\index{main3.\+c@{main3.\+c}!I\+T\+E\+R@{I\+T\+E\+R}}
\index{I\+T\+E\+R@{I\+T\+E\+R}!main3.\+c@{main3.\+c}}
\subsubsection[{I\+T\+E\+R}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+T\+E\+R~10000}}\label{main3_8c_ab5b92945430bd0cb7a04673282cf70c3}
\hypertarget{main3_8c_ac24e1ca366317fc627e4ba6ec3cbc67b}{\index{main3.\+c@{main3.\+c}!rdtscll@{rdtscll}}
\index{rdtscll@{rdtscll}!main3.\+c@{main3.\+c}}
\subsubsection[{rdtscll}]{\setlength{\rightskip}{0pt plus 5cm}\#define rdtscll(
\begin{DoxyParamCaption}
\item[{}]{val}
\end{DoxyParamCaption}
)~\+\_\+\+\_\+asm\+\_\+\+\_\+ \+\_\+\+\_\+volatile\+\_\+\+\_\+(\char`\"{}rdtsc\char`\"{} \+: \char`\"{}=A\char`\"{} (val))}}\label{main3_8c_ac24e1ca366317fc627e4ba6ec3cbc67b}


\subsection{Function Documentation}
\hypertarget{main3_8c_a8b3ab68dc6ae48f6c2b2683734a55624}{\index{main3.\+c@{main3.\+c}!fn\+\_\+async\+\_\+steam@{fn\+\_\+async\+\_\+steam}}
\index{fn\+\_\+async\+\_\+steam@{fn\+\_\+async\+\_\+steam}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+async\+\_\+steam}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+async\+\_\+steam (
\begin{DoxyParamCaption}
\item[{lwt\+\_\+chan\+\_\+t}]{to}
\end{DoxyParamCaption}
)}}\label{main3_8c_a8b3ab68dc6ae48f6c2b2683734a55624}
\hypertarget{main3_8c_ae14ebcd5dbd5dc45bb763e27bfdab8be}{\index{main3.\+c@{main3.\+c}!fn\+\_\+bounce@{fn\+\_\+bounce}}
\index{fn\+\_\+bounce@{fn\+\_\+bounce}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+bounce}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+bounce (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{main3_8c_ae14ebcd5dbd5dc45bb763e27bfdab8be}
\hypertarget{main3_8c_acb0898cb622df2c21d89396818622817}{\index{main3.\+c@{main3.\+c}!fn\+\_\+chan@{fn\+\_\+chan}}
\index{fn\+\_\+chan@{fn\+\_\+chan}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+chan}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+chan (
\begin{DoxyParamCaption}
\item[{lwt\+\_\+chan\+\_\+t}]{to}
\end{DoxyParamCaption}
)}}\label{main3_8c_acb0898cb622df2c21d89396818622817}
\hypertarget{main3_8c_a86bf63b3460ce6076daf8fb200b3946d}{\index{main3.\+c@{main3.\+c}!fn\+\_\+grpwait@{fn\+\_\+grpwait}}
\index{fn\+\_\+grpwait@{fn\+\_\+grpwait}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+grpwait}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+grpwait (
\begin{DoxyParamCaption}
\item[{lwt\+\_\+chan\+\_\+t}]{c}
\end{DoxyParamCaption}
)}}\label{main3_8c_a86bf63b3460ce6076daf8fb200b3946d}
\hypertarget{main3_8c_a30645ee9e662784cc10b862398ebcc1b}{\index{main3.\+c@{main3.\+c}!fn\+\_\+identity@{fn\+\_\+identity}}
\index{fn\+\_\+identity@{fn\+\_\+identity}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+identity}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+identity (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{main3_8c_a30645ee9e662784cc10b862398ebcc1b}
\hypertarget{main3_8c_abb3978a7add7702306e8e04a08da168a}{\index{main3.\+c@{main3.\+c}!fn\+\_\+join@{fn\+\_\+join}}
\index{fn\+\_\+join@{fn\+\_\+join}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+join}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+join (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{main3_8c_abb3978a7add7702306e8e04a08da168a}
\hypertarget{main3_8c_a2239ef46ee61712a03e136bdf12f48f8}{\index{main3.\+c@{main3.\+c}!fn\+\_\+nested\+\_\+joins@{fn\+\_\+nested\+\_\+joins}}
\index{fn\+\_\+nested\+\_\+joins@{fn\+\_\+nested\+\_\+joins}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+nested\+\_\+joins}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+nested\+\_\+joins (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{main3_8c_a2239ef46ee61712a03e136bdf12f48f8}
\hypertarget{main3_8c_ae27eac94e8bd220bd0eb50f4d162a76c}{\index{main3.\+c@{main3.\+c}!fn\+\_\+null@{fn\+\_\+null}}
\index{fn\+\_\+null@{fn\+\_\+null}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+null}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+null (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{main3_8c_ae27eac94e8bd220bd0eb50f4d162a76c}
\hypertarget{main3_8c_a24b5f091923e0e385cdc00c7203743e8}{\index{main3.\+c@{main3.\+c}!fn\+\_\+sequence@{fn\+\_\+sequence}}
\index{fn\+\_\+sequence@{fn\+\_\+sequence}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+sequence}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+sequence (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{main3_8c_a24b5f091923e0e385cdc00c7203743e8}
\hypertarget{main3_8c_a984f793205bf1b2e018162f3b3982117}{\index{main3.\+c@{main3.\+c}!fn\+\_\+snder@{fn\+\_\+snder}}
\index{fn\+\_\+snder@{fn\+\_\+snder}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+snder}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+snder (
\begin{DoxyParamCaption}
\item[{lwt\+\_\+chan\+\_\+t}]{c, }
\item[{int}]{v}
\end{DoxyParamCaption}
)}}\label{main3_8c_a984f793205bf1b2e018162f3b3982117}
\hypertarget{main3_8c_af57a14139aab6bc433c03c023339a2bb}{\index{main3.\+c@{main3.\+c}!fn\+\_\+snder\+\_\+1@{fn\+\_\+snder\+\_\+1}}
\index{fn\+\_\+snder\+\_\+1@{fn\+\_\+snder\+\_\+1}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+snder\+\_\+1}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+snder\+\_\+1 (
\begin{DoxyParamCaption}
\item[{lwt\+\_\+chan\+\_\+t}]{c}
\end{DoxyParamCaption}
)}}\label{main3_8c_af57a14139aab6bc433c03c023339a2bb}
\hypertarget{main3_8c_a5cd13e32f6cffd4ed63edb950213392f}{\index{main3.\+c@{main3.\+c}!fn\+\_\+snder\+\_\+2@{fn\+\_\+snder\+\_\+2}}
\index{fn\+\_\+snder\+\_\+2@{fn\+\_\+snder\+\_\+2}!main3.\+c@{main3.\+c}}
\subsubsection[{fn\+\_\+snder\+\_\+2}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ fn\+\_\+snder\+\_\+2 (
\begin{DoxyParamCaption}
\item[{lwt\+\_\+chan\+\_\+t}]{c}
\end{DoxyParamCaption}
)}}\label{main3_8c_a5cd13e32f6cffd4ed63edb950213392f}
\hypertarget{main3_8c_a840291bc02cba5474a4cb46a9b9566fe}{\index{main3.\+c@{main3.\+c}!main@{main}}
\index{main@{main}!main3.\+c@{main3.\+c}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{main3_8c_a840291bc02cba5474a4cb46a9b9566fe}
\hypertarget{main3_8c_a5e23c5a942628a1f2d682009e0366655}{\index{main3.\+c@{main3.\+c}!test\+\_\+crt\+\_\+join\+\_\+sched@{test\+\_\+crt\+\_\+join\+\_\+sched}}
\index{test\+\_\+crt\+\_\+join\+\_\+sched@{test\+\_\+crt\+\_\+join\+\_\+sched}!main3.\+c@{main3.\+c}}
\subsubsection[{test\+\_\+crt\+\_\+join\+\_\+sched}]{\setlength{\rightskip}{0pt plus 5cm}void test\+\_\+crt\+\_\+join\+\_\+sched (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{main3_8c_a5e23c5a942628a1f2d682009e0366655}
\hypertarget{main3_8c_a7c9d5eef978a751f1d94df73823a181a}{\index{main3.\+c@{main3.\+c}!test\+\_\+grpwait@{test\+\_\+grpwait}}
\index{test\+\_\+grpwait@{test\+\_\+grpwait}!main3.\+c@{main3.\+c}}
\subsubsection[{test\+\_\+grpwait}]{\setlength{\rightskip}{0pt plus 5cm}void test\+\_\+grpwait (
\begin{DoxyParamCaption}
\item[{int}]{chsz, }
\item[{int}]{grpsz}
\end{DoxyParamCaption}
)}}\label{main3_8c_a7c9d5eef978a751f1d94df73823a181a}
Q\+: why don't we iterate through all of the data here?

A\+: We need to fix 1) cevt\+\_\+wait to be level triggered, or 2) provide a function to detect if there is data available on a channel. Either of these would allows us to iterate on a channel while there is more data pending.\hypertarget{main3_8c_a4706597a095cdd68502e0a0a7bc10fc1}{\index{main3.\+c@{main3.\+c}!test\+\_\+multisend@{test\+\_\+multisend}}
\index{test\+\_\+multisend@{test\+\_\+multisend}!main3.\+c@{main3.\+c}}
\subsubsection[{test\+\_\+multisend}]{\setlength{\rightskip}{0pt plus 5cm}void test\+\_\+multisend (
\begin{DoxyParamCaption}
\item[{int}]{chsz}
\end{DoxyParamCaption}
)}}\label{main3_8c_a4706597a095cdd68502e0a0a7bc10fc1}
\hypertarget{main3_8c_a3da997789e6bfbfb86c7c7a18b1e968b}{\index{main3.\+c@{main3.\+c}!test\+\_\+perf@{test\+\_\+perf}}
\index{test\+\_\+perf@{test\+\_\+perf}!main3.\+c@{main3.\+c}}
\subsubsection[{test\+\_\+perf}]{\setlength{\rightskip}{0pt plus 5cm}void test\+\_\+perf (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{main3_8c_a3da997789e6bfbfb86c7c7a18b1e968b}
\hypertarget{main3_8c_a2f7cc657f5403703651e8a5cbecbc19a}{\index{main3.\+c@{main3.\+c}!test\+\_\+perf\+\_\+async\+\_\+steam@{test\+\_\+perf\+\_\+async\+\_\+steam}}
\index{test\+\_\+perf\+\_\+async\+\_\+steam@{test\+\_\+perf\+\_\+async\+\_\+steam}!main3.\+c@{main3.\+c}}
\subsubsection[{test\+\_\+perf\+\_\+async\+\_\+steam}]{\setlength{\rightskip}{0pt plus 5cm}void test\+\_\+perf\+\_\+async\+\_\+steam (
\begin{DoxyParamCaption}
\item[{int}]{chsz}
\end{DoxyParamCaption}
)}}\label{main3_8c_a2f7cc657f5403703651e8a5cbecbc19a}
\hypertarget{main3_8c_adbca2609b42b9d6b35a8077ac1e1f74d}{\index{main3.\+c@{main3.\+c}!test\+\_\+perf\+\_\+channels@{test\+\_\+perf\+\_\+channels}}
\index{test\+\_\+perf\+\_\+channels@{test\+\_\+perf\+\_\+channels}!main3.\+c@{main3.\+c}}
\subsubsection[{test\+\_\+perf\+\_\+channels}]{\setlength{\rightskip}{0pt plus 5cm}void test\+\_\+perf\+\_\+channels (
\begin{DoxyParamCaption}
\item[{int}]{chsz}
\end{DoxyParamCaption}
)}}\label{main3_8c_adbca2609b42b9d6b35a8077ac1e1f74d}


\subsection{Variable Documentation}
\hypertarget{main3_8c_ad25cac179548d50aa5d5bf5739de6e22}{\index{main3.\+c@{main3.\+c}!curr@{curr}}
\index{curr@{curr}!main3.\+c@{main3.\+c}}
\subsubsection[{curr}]{\setlength{\rightskip}{0pt plus 5cm}volatile int curr = 0}}\label{main3_8c_ad25cac179548d50aa5d5bf5739de6e22}
\hypertarget{main3_8c_a545d0b226289b96d49f8744423287519}{\index{main3.\+c@{main3.\+c}!sched@{sched}}
\index{sched@{sched}!main3.\+c@{main3.\+c}}
\subsubsection[{sched}]{\setlength{\rightskip}{0pt plus 5cm}volatile int sched\mbox{[}2\mbox{]} = \{0, 0\}}}\label{main3_8c_a545d0b226289b96d49f8744423287519}
